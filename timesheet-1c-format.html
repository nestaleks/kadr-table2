<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Табель обліку робочого часу (формат 1С)</title>
    <link rel="stylesheet" href="timesheet-1c-format.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="document-container">
        <!-- Заголовок документа -->
        <div class="document-header">
            <div class="organization-info">
                <div class="org-field">
                    <label>Підприємство:</label>
                    <input type="text" id="organizationName" value="ТОВ «Назва підприємства»" class="org-input">
                </div>
                <div class="org-field">
                    <label>Код ЄДРПОУ:</label>
                    <input type="text" id="edrpouCode" value="12345678" class="org-input">
                </div>
            </div>
            
            <div class="document-title">
                <h1>ТАБЕЛЬ ОБЛІКУ РОБОЧОГО ЧАСУ</h1>
                <div class="document-number">
                    <label>№</label>
                    <input type="text" id="documentNumber" value="001" class="doc-input">
                    <label>за</label>
                    <select id="periodMonth" class="doc-input">
                        <option value="0">січень</option>
                        <option value="1">лютий</option>
                        <option value="2" selected>березень</option>
                        <option value="3">квітень</option>
                        <option value="4">травень</option>
                        <option value="5">червень</option>
                        <option value="6">липень</option>
                        <option value="7">серпень</option>
                        <option value="8">вересень</option>
                        <option value="9">жовтень</option>
                        <option value="10">листопад</option>
                        <option value="11">грудень</option>
                    </select>
                    <input type="number" id="periodYear" value="2025" min="2020" max="2030" class="doc-input">
                    <label>року</label>
                </div>
            </div>
        </div>

        <!-- Панель управління -->
        <div class="control-panel">
            <div class="control-group">
                <button class="btn btn-primary" id="generateTimesheet">
                    <i class="fas fa-calendar-alt"></i> Згенерувати табель
                </button>
                <button class="btn btn-success" id="addEmployeeBtn">
                    <i class="fas fa-user-plus"></i> Знайти співробітника
                </button>
                <button class="btn btn-info" id="fillWorkingDays">
                    <i class="fas fa-magic"></i> Заповнити робочі дні
                </button>
            </div>
            <div class="control-group">
                <button class="btn btn-warning" id="calculateTotals">
                    <i class="fas fa-calculator"></i> Підрахувати підсумки
                </button>
                <button class="btn btn-secondary" id="exportExcel">
                    <i class="fas fa-file-excel"></i> Експорт в Excel
                </button>
                <button class="btn btn-secondary" id="printTimesheet">
                    <i class="fas fa-print"></i> Друк
                </button>
            </div>
        </div>

        <!-- Вкладки підрозділів -->
        <div class="departments-tabs" id="departmentsTabs">
            <div class="tabs-header">
                <button class="tab-btn active" data-department="all">
                    <i class="fas fa-users"></i> Всі співробітники
                </button>
            </div>
        </div>

        <!-- Основна таблиця табеля -->
        <div class="timesheet-wrapper">
            <div class="current-department-info">
                <h3 id="currentDepartmentName">Всі співробітники</h3>
                <div class="department-stats">
                    <span>Співробітників: <span id="departmentEmployeeCount">0</span></span>
                    <span>Робочих днів: <span id="departmentWorkDays">0</span></span>
                </div>
            </div>
            
            <table class="timesheet-table" id="timesheetTable">
                <!-- Заголовок таблиці буде згенеровано динамічно -->
            </table>
        </div>

        <!-- Підсумкова інформація -->
        <div class="summary-section">
            <div class="summary-row">
                <span class="summary-label">Кількість робочих днів у періоді:</span>
                <span class="summary-value" id="workingDaysInPeriod">22</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Кількість святкових днів у періоді:</span>
                <span class="summary-value" id="holidaysInPeriod">1</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Загальна кількість співробітників:</span>
                <span class="summary-value" id="totalEmployees">0</span>
            </div>
        </div>

        <!-- Підписи -->
        <div class="signatures-section">
            <div class="signature-block">
                <div class="signature-line">
                    <span class="signature-role">Керівник:</span>
                    <div class="signature-placeholder">
                        <span class="signature-line-text">_________________</span>
                        <input type="text" class="signature-name" placeholder="Прізвище та ініціали">
                    </div>
                </div>
                <div class="signature-date">
                    <label>Дата:</label>
                    <input type="date" class="signature-date-input" id="signatureDate">
                </div>
            </div>
            
            <div class="signature-block">
                <div class="signature-line">
                    <span class="signature-role">Відповідальна особа:</span>
                    <div class="signature-placeholder">
                        <span class="signature-line-text">_________________</span>
                        <input type="text" class="signature-name" placeholder="Прізвище та ініціали">
                    </div>
                </div>
                <div class="signature-date">
                    <label>Дата:</label>
                    <input type="date" class="signature-date-input">
                </div>
            </div>
        </div>

        <!-- Умовні позначення -->
        <div class="legend-section">
            <h3>Умовні позначення</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <span class="legend-code">Я</span>
                    <span class="legend-desc">Явка на роботу</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">В</span>
                    <span class="legend-desc">Відпустка</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">Л</span>
                    <span class="legend-desc">Лікарняний</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">К</span>
                    <span class="legend-desc">Відрядження</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">Н</span>
                    <span class="legend-desc">Неявка невиправдана</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">П</span>
                    <span class="legend-desc">Прогул</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">Р</span>
                    <span class="legend-desc">Вихідний день</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">С</span>
                    <span class="legend-desc">Святковий день</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">М</span>
                    <span class="legend-desc">Відпустка по догляду за дитиною</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">Д</span>
                    <span class="legend-desc">Додаткова відпустка</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">З</span>
                    <span class="legend-desc">Запізнення</span>
                </div>
                <div class="legend-item">
                    <span class="legend-code">О</span>
                    <span class="legend-desc">Понаднормовий час</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальне вікно пошуку співробітника -->
    <div class="modal" id="employeeSearchModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-search"></i> Пошук співробітника</h3>
                <button class="modal-close" id="closeSearchModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="search-section">
                    <div class="search-controls">
                        <div class="search-input-group">
                            <input type="text" id="employeeSearchInput" placeholder="Введіть ПІБ, табельний номер або посаду..." class="search-input">
                            <button class="btn btn-primary" id="searchEmployeeBtn">
                                <i class="fas fa-search"></i> Знайти
                            </button>
                        </div>
                        
                        <div class="search-filters">
                            <div class="filter-group">
                                <label>Підрозділ:</label>
                                <select id="searchDepartmentFilter" class="form-control">
                                    <option value="">Всі підрозділи</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Статус:</label>
                                <select id="searchStatusFilter" class="form-control">
                                    <option value="all">Всі співробітники</option>
                                    <option value="active">Активні</option>
                                    <option value="inactive">Неактивні/Звільнені</option>
                                    <option value="worked">Працювали в періоді</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="search-results" id="searchResults">
                        <div class="no-results">
                            <i class="fas fa-search"></i>
                            <p>Введіть дані для пошуку співробітника</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="addSelectedEmployees" disabled>
                    <i class="fas fa-user-plus"></i> Додати вибраних (<span id="selectedCount">0</span>)
                </button>
                <button class="btn btn-secondary" id="cancelSearch">
                    <i class="fas fa-times"></i> Закрити
                </button>
            </div>
        </div>
    </div>

    <!-- Модальне вікно створення табеля -->
    <div class="modal" id="generateTimesheetModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-plus"></i> Створити табель</h3>
                <button class="modal-close" id="closeGenerateModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="generateTimesheetForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="generateMonth">Місяць:</label>
                            <select id="generateMonth" required>
                                <option value="0">Січень</option>
                                <option value="1">Лютий</option>
                                <option value="2">Березень</option>
                                <option value="3">Квітень</option>
                                <option value="4">Травень</option>
                                <option value="5">Червень</option>
                                <option value="6">Липень</option>
                                <option value="7">Серпень</option>
                                <option value="8">Вересень</option>
                                <option value="9">Жовтень</option>
                                <option value="10">Листопад</option>
                                <option value="11">Грудень</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="generateYear">Рік:</label>
                            <input type="number" id="generateYear" value="2025" min="2020" max="2030" required>
                        </div>
                    </div>
                    
                    <div class="auto-fill-options">
                        <h4>Автоматичне заповнення:</h4>
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="includeActiveEmployees" checked>
                                Включити всіх активних співробітників
                            </label>
                            <label>
                                <input type="checkbox" id="includeWorkedInPeriod" checked>
                                Включити співробітників, що працювали в періоді (включно зі звільненими)
                            </label>
                            <label>
                                <input type="checkbox" id="includeInactiveEmployees">
                                Включити всіх звільнених співробітників
                            </label>
                        </div>
                    </div>
                    
                    <div class="department-selection">
                        <h4>Підрозділи:</h4>
                        <div id="departmentCheckboxes">
                            <!-- Заповнюється динамічно -->
                        </div>
                    </div>
                    
                    <div class="generation-summary">
                        <div class="summary-item">
                            <span>Буде додано співробітників: <strong id="estimatedCount">0</strong></span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="confirmGenerate">
                    <i class="fas fa-calendar-alt"></i> Створити табель
                </button>
                <button class="btn btn-secondary" id="cancelGenerate">
                    <i class="fas fa-times"></i> Скасувати
                </button>
            </div>
        </div>
    </div>

    <!-- Завантаження скриптів -->
    <script src="database.js"></script>
    <script src="timesheet-1c-format.js"></script>
</body>
</html>